# Edit ëª¨ë“œ ì•Œê³ ë¦¬ì¦˜ ë¬¸ì„œ

> **ì‘ì„±ì¼**: 2025-11-02
> **ëª©ì **: Edit ëª¨ë“œì˜ ë™ì‘ ì›ë¦¬ì™€ ìˆœìœ„ ì¡°ì‘ ì•Œê³ ë¦¬ì¦˜ì„ ìƒì„¸íˆ ë¬¸ì„œí™”

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [í•µì‹¬ ê°œë…](#í•µì‹¬-ê°œë…)
3. [ì›Œí¬í”Œë¡œìš° ìˆœì„œ](#ì›Œí¬í”Œë¡œìš°-ìˆœì„œ)
4. [DOM êµ¬ì¡° ë¶„ì„](#dom-êµ¬ì¡°-ë¶„ì„)
5. [ìˆœìœ„ ì¡°ì‘ ì•Œê³ ë¦¬ì¦˜](#ìˆœìœ„-ì¡°ì‘-ì•Œê³ ë¦¬ì¦˜)
6. [ì£¼ìš” íŒŒì¼ ë° í•¨ìˆ˜](#ì£¼ìš”-íŒŒì¼-ë°-í•¨ìˆ˜)
7. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## ê°œìš”

**Edit ëª¨ë“œ**ëŠ” ì¿ íŒ¡ ê²€ìƒ‰ ê²°ê³¼ì—ì„œ íŠ¹ì • ìƒí’ˆì„ ì°¾ì•„ **ì›í•˜ëŠ” ìˆœìœ„ë¡œ ì´ë™**ì‹œí‚¤ê³ , **P/I/V ì •ë³´ë¥¼ ë®ì–´ì”Œìš´** í›„ ìŠ¤í¬ë¦°ìƒ·ì„ ìº¡ì²˜í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

### ì£¼ìš” ê¸°ëŠ¥

- âœ… ìƒí’ˆ ê²€ìƒ‰ ë° ë§¤ì¹­ (Product ID, Item ID, Vendor Item ID)
- âœ… ìˆœìœ„ ì¡°ì‘ (DOM ì¬êµ¬ì„±)
- âœ… P/I/V ì •ë³´ ë®ì–´ì”Œìš°ê¸°
- âœ… í•˜ì´ë¼ì´íŠ¸ íš¨ê³¼ (ë¹¨ê°„ í…Œë‘ë¦¬ + P/I/V ë¼ë²¨ + ìˆœìœ„ ë±ƒì§€)
- âœ… Before/After ìŠ¤í¬ë¦°ìƒ·
- âœ… ì›Œí„°ë§ˆí¬ ì œê±°

---

## í•µì‹¬ ê°œë…

### 1. ìƒí’ˆ ì‹ë³„ì

ì¿ íŒ¡ ìƒí’ˆì€ 3ê°€ì§€ IDë¡œ ì‹ë³„ë©ë‹ˆë‹¤:

| ID | ì˜ˆì‹œ | ì„¤ëª… |
|---|---|---|
| **Product ID** | `8430027935` | ìƒí’ˆ ê³ ìœ  ë²ˆí˜¸ |
| **Item ID** | `33333331730` | ì•„ì´í…œ ë²ˆí˜¸ (ì˜µì…˜ ë‹¨ìœ„) |
| **Vendor Item ID** | `92625424877` | íŒë§¤ì ì•„ì´í…œ ë²ˆí˜¸ |

### 2. DOM ìš”ì†Œ ë¶„ë¥˜

ì¿ íŒ¡ ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ì˜ `#product-list > li` ìš”ì†ŒëŠ” 3ê°€ì§€ë¡œ ë¶„ë¥˜ë©ë‹ˆë‹¤:

```
ğŸ”‘ í•µì‹¬ ê·œì¹™: ProductUnit_prodcutUnit__ í´ë˜ìŠ¤ ìœ ë¬´ë¡œ êµ¬ë¶„

âœ… ProductUnit_prodcutUnit__ ìˆìŒ:
   â”œâ”€ ì¼ë°˜ ìƒí’ˆ (rank íŒŒë¼ë¯¸í„° ìˆìŒ, AdMark ì—†ìŒ) â†’ ì¬ì •ë ¬ ëŒ€ìƒ
   â””â”€ ê´‘ê³  (rank íŒŒë¼ë¯¸í„° ì—†ìŒ or AdMark ìˆìŒ) â†’ ì›ìœ„ì¹˜ ê³ ì •

âŒ ProductUnit_prodcutUnit__ ì—†ìŒ:
   â””â”€ íŠ¹ìˆ˜ ì„¹ì…˜ (ë² ìŠ¤íŠ¸ìƒí’ˆ, í•œì •íŠ¹ê°€, ë°°ë„ˆ ë“±) â†’ ì›ìœ„ì¹˜ ê³ ì •
```

### 3. ìˆœìœ„ ì²´ê³„

#### ì „ì²´ ìˆœìœ„ (Absolute Rank)
- ê²€ìƒ‰ ê²°ê³¼ ì „ì²´ì—ì„œì˜ ìˆœìœ„ (1ë“±ë¶€í„° ì‹œì‘)
- í˜ì´ì§€ ë²ˆí˜¸ì™€ ë¬´ê´€í•œ ì ˆëŒ€ ìˆœìœ„

#### í˜ì´ì§€ ë‚´ ìˆœìœ„ (Relative Rank)
- í˜„ì¬ í˜ì´ì§€ì—ì„œì˜ ìƒëŒ€ ìˆœìœ„ (1~72ë“±)
- DOM ì¡°ì‘ ì‹œ ì‚¬ìš©ë˜ëŠ” ì‹¤ì œ ì¸ë±ìŠ¤

**ì˜ˆì‹œ**:
- ì „ì²´ 13ë“± â†’ í˜ì´ì§€ 1 (1~72ë“±) â†’ í˜ì´ì§€ ë‚´ 13ë“±
- ì „ì²´ 85ë“± â†’ í˜ì´ì§€ 2 (73~144ë“±) â†’ í˜ì´ì§€ ë‚´ 13ë“± (85 - 72 = 13)

---

## ì›Œí¬í”Œë¡œìš° ìˆœì„œ

### ì „ì²´ íë¦„

```
1. ìƒí’ˆ ê²€ìƒ‰
   â†“
2. ìƒí’ˆ ë§¤ì¹­ (Product ID, Item ID, Vendor Item ID)
   â†“
3. í˜ì´ì§€ ì´ë™ ì—¬ë¶€ íŒë‹¨
   â”œâ”€ ê°™ì€ í˜ì´ì§€: í˜ì´ì§€ ì´ë™ ìƒëµ
   â””â”€ ë‹¤ë¥¸ í˜ì´ì§€: ëª©í‘œ í˜ì´ì§€ë¡œ ì´ë™
   â†“
4. "ë³€ê²½ ì „" ìŠ¤í¬ë¦°ìƒ· (í•˜ì´ë¼ì´íŠ¸ ì—†ìŒ) âš ï¸ ì¤‘ìš”!
   â†“
5. ìˆœìœ„ ì¡°ì‘ (DOM ì¬êµ¬ì„±)
   â†“
6. í•˜ì´ë¼ì´íŠ¸ ì ìš© (ë¹¨ê°„ í…Œë‘ë¦¬ + P/I/V ë¼ë²¨)
   â†“
7. "ë³€ê²½ í›„" ìŠ¤í¬ë¦°ìƒ· (í•˜ì´ë¼ì´íŠ¸ ìˆìŒ)
   â†“
8. ìµœì¢… ê²°ê³¼ ìš”ì•½ ì¶œë ¥
```

### âš ï¸ ì¤‘ìš”: í•˜ì´ë¼ì´íŠ¸ ì ìš© ìˆœì„œ

**âŒ ì˜ëª»ëœ ìˆœì„œ (ë¬¸ì œ ë°œìƒ)**:
```
1. í•˜ì´ë¼ì´íŠ¸ ì ìš© (ì›ë˜ ìœ„ì¹˜)
2. ìŠ¤í¬ë¦°ìƒ· Before
3. ìˆœìœ„ ì¡°ì‘ (DOM ì´ë™)
4. í•˜ì´ë¼ì´íŠ¸ ì¬ì ìš© (ìƒˆ ìœ„ì¹˜)
5. ìŠ¤í¬ë¦°ìƒ· After

â†’ ë¬¸ì œ: ì›ë˜ ìœ„ì¹˜ì˜ í•˜ì´ë¼ì´íŠ¸ê°€ ë‚¨ì•„ìˆìŒ!
```

**âœ… ì˜¬ë°”ë¥¸ ìˆœì„œ**:
```
1. ìŠ¤í¬ë¦°ìƒ· Before (í•˜ì´ë¼ì´íŠ¸ ì—†ìŒ)
2. ìˆœìœ„ ì¡°ì‘ (DOM ì´ë™)
3. í•˜ì´ë¼ì´íŠ¸ ì ìš© (ìƒˆ ìœ„ì¹˜ì—ë§Œ)
4. ìŠ¤í¬ë¦°ìƒ· After

â†’ í•´ê²°: ìƒˆ ìœ„ì¹˜ì—ë§Œ í•˜ì´ë¼ì´íŠ¸ í‘œì‹œë¨
```

**ì½”ë“œ ìœ„ì¹˜**: `lib/workflows/search_workflow.py:608-792`

---

## DOM êµ¬ì¡° ë¶„ì„

### analyze_product_list_structure()

**íŒŒì¼**: `lib/modules/product_finder.py:26-168`

#### ëª©ì 
ì¿ íŒ¡ ê²€ìƒ‰ ê²°ê³¼ í˜ì´ì§€ì˜ DOM êµ¬ì¡°ë¥¼ ë¶„ì„í•˜ì—¬ ì¼ë°˜ ìƒí’ˆ, ê´‘ê³ , íŠ¹ìˆ˜ ì„¹ì…˜ì„ êµ¬ë¶„í•©ë‹ˆë‹¤.

#### ì•Œê³ ë¦¬ì¦˜

```python
# 1. ëª¨ë“  li ìš”ì†Œ ì¶”ì¶œ
all_items = driver.find_elements(By.CSS_SELECTOR, "#product-list > li[data-id]")

# 2. ê° li ìˆœíšŒí•˜ë©° ë¶„ë¥˜
for dom_index, item in enumerate(all_items):
    item_class = item.get_attribute('class')

    # Step 1: ProductUnit í´ë˜ìŠ¤ ì²´í¬
    is_product_unit = 'ProductUnit_prodcutUnit__' in item_class

    if not is_product_unit:
        # íŠ¹ìˆ˜ ì„¹ì…˜ â†’ is_ad=True (ì›ìœ„ì¹˜ ê³ ì •)
        continue

    # Step 2: ìƒí’ˆ ë§í¬ ì¶”ì¶œ
    link = item.find_element(By.CSS_SELECTOR, 'a[href*="/vp/products/"]')

    # Step 3: ê´‘ê³  íŒë³„
    has_rank_param = ("&rank=" in link)
    has_ad_mark = item.find_element(By.CSS_SELECTOR, '[class*="AdMark"]')

    if has_rank_param and not has_ad_mark:
        # ì¼ë°˜ ìƒí’ˆ â†’ is_ad=False (ì¬ì •ë ¬ ëŒ€ìƒ)
        organic_products.append(item)
    else:
        # ê´‘ê³  â†’ is_ad=True (ì›ìœ„ì¹˜ ê³ ì •)
        pass
```

#### ë°˜í™˜ê°’

```python
{
    "all_items": List[WebElement],         # ëª¨ë“  li ìš”ì†Œ
    "items_info": List[Dict],              # ê° ìš”ì†Œì˜ ë©”íƒ€ë°ì´í„°
    "organic_products": List[WebElement],  # ì¼ë°˜ ìƒí’ˆë§Œ
    "organic_dom_indices": List[int]       # ì¼ë°˜ ìƒí’ˆì˜ DOM ì¸ë±ìŠ¤
}
```

#### items_info êµ¬ì¡°

```python
# ì¼ë°˜ ìƒí’ˆ
{
    "dom_index": 0,           # DOMì—ì„œì˜ ìœ„ì¹˜
    "is_ad": False,           # ì¬ì •ë ¬ ëŒ€ìƒ
    "rank": 1,                # ìˆœìœ„
    "type": "ì¼ë°˜",
    "product_id": "8430027935",
    "item_id": "33333331730",
    "vendor_item_id": "92625424877"
}

# ê´‘ê³ 
{
    "dom_index": 3,
    "is_ad": True,            # ì›ìœ„ì¹˜ ê³ ì •
    "rank": None,
    "type": "ê´‘ê³ ",
    ...
}

# íŠ¹ìˆ˜ ì„¹ì…˜
{
    "dom_index": 7,
    "is_ad": True,            # ì›ìœ„ì¹˜ ê³ ì •
    "rank": None,
    "type": "íŠ¹ìˆ˜ì„¹ì…˜(ë¹„ProductUnit)",
    "product_id": None,
    "item_id": None,
    "vendor_item_id": None
}
```

---

## ìˆœìœ„ ì¡°ì‘ ì•Œê³ ë¦¬ì¦˜

### move_product_to_rank()

**íŒŒì¼**: `lib/modules/rank_manipulator.py:45-132`

#### ëª©ì 
íŠ¹ì • ìƒí’ˆì„ ì›í•˜ëŠ” ìˆœìœ„ë¡œ ì´ë™ì‹œí‚¤ê¸° ìœ„í•´ DOMì„ ì¬êµ¬ì„±í•©ë‹ˆë‹¤.

#### ì•Œê³ ë¦¬ì¦˜

```
Step 1: í˜„ì¬ ìˆœìœ„ í™•ì¸
  - target_productì˜ í˜„ì¬ ìˆœìœ„ (page_rank)
  - desired_rankì™€ ë¹„êµ

Step 2: ì¼ë°˜ ìƒí’ˆ ì¬ì •ë ¬
  - _reorder_products() í˜¸ì¶œ
  - ëª©í‘œ ìƒí’ˆì„ desired_rank ìœ„ì¹˜ë¡œ ì´ë™
  - ë‚˜ë¨¸ì§€ ìƒí’ˆì€ ìˆœì„œ ìœ ì§€í•˜ë©° ë°€ë¦¼

Step 3: DOM ì¬êµ¬ì„±
  - _rebuild_dom_with_fixed_ads() í˜¸ì¶œ
  - ê´‘ê³ /íŠ¹ìˆ˜ì„¹ì…˜ ì›ìœ„ì¹˜ ìœ ì§€
  - ì¬ì •ë ¬ëœ ì¼ë°˜ ìƒí’ˆì„ ë¹ˆ ìë¦¬ì— ë¼ì›Œë„£ê¸°

Step 4: ì›Œí„°ë§ˆí¬ ì¬ìƒì„±
  - _remove_all_watermarks() - ê¸°ì¡´ ì›Œí„°ë§ˆí¬ ì œê±°
  - _create_new_watermarks() - ìƒˆ ìˆœìœ„ì— ë§ê²Œ ìƒì„±

Step 5: ê²€ì¦
  - verify_new_order() - ì¬ë°°ì¹˜ í›„ ìˆœì„œ í™•ì¸
```

### _reorder_products()

**íŒŒì¼**: `lib/modules/rank_manipulator.py:108-134`

#### ì•Œê³ ë¦¬ì¦˜

```python
# ì˜ˆì‹œ: 13ë“± â†’ 1ë“± ì´ë™

before = [1, 2, 3, ..., 13, 14, 15]

# Step 1: ëª©í‘œ ìƒí’ˆ ì œê±°
target = products[12]  # 13ë“± (0-based index)
remaining = [1, 2, 3, ..., 12, 14, 15]

# Step 2: desired_rank ìœ„ì¹˜ì— ì‚½ì…
reordered = [target, 1, 2, 3, ..., 12, 14, 15]
           # 13ë“±ì´ 1ë“±ìœ¼ë¡œ ì´ë™, ë‚˜ë¨¸ì§€ëŠ” í•œ ì¹¸ì”© ë°€ë¦¼

after = [13, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, ...]
```

### _rebuild_dom_with_fixed_ads()

**íŒŒì¼**: `lib/modules/rank_manipulator.py:136-201`

#### í•µì‹¬ ë¡œì§

```python
# ì›ë³¸ DOM êµ¬ì¡°:
DOM[0] = ì¼ë°˜ ìƒí’ˆ (rank=1)
DOM[1] = ê´‘ê³ 
DOM[2] = ì¼ë°˜ ìƒí’ˆ (rank=2)
DOM[3] = íŠ¹ìˆ˜ ì„¹ì…˜ (ë² ìŠ¤íŠ¸ìƒí’ˆ)
DOM[4] = ì¼ë°˜ ìƒí’ˆ (rank=3)

# items_info ìˆœì„œëŒ€ë¡œ ìˆœíšŒ
organic_idx = 0

for idx, item_info in enumerate(items_info):
    if item_info['is_ad']:
        # ê´‘ê³ /íŠ¹ìˆ˜ì„¹ì…˜ â†’ ì›ë˜ element ì‚¬ìš©
        element = all_items[item_info['dom_index']]
    else:
        # ì¼ë°˜ ìƒí’ˆ â†’ ì¬ì •ë ¬ëœ ìˆœì„œì—ì„œ ê°€ì ¸ì˜¤ê¸°
        element = reordered_products[organic_idx]
        organic_idx += 1

    # ì»¨í…Œì´ë„ˆ ëì— ìˆœì„œëŒ€ë¡œ ì¶”ê°€
    container.appendChild(element)
```

#### ê²°ê³¼

```
ì¬êµ¬ì„±ëœ DOM:
DOM[0] = ì¼ë°˜ ìƒí’ˆ (ìƒˆ 1ë“±) â† ì¬ì •ë ¬ë¨
DOM[1] = ê´‘ê³               â† ì›ìœ„ì¹˜ ìœ ì§€
DOM[2] = ì¼ë°˜ ìƒí’ˆ (ìƒˆ 2ë“±) â† ì¬ì •ë ¬ë¨
DOM[3] = íŠ¹ìˆ˜ ì„¹ì…˜         â† ì›ìœ„ì¹˜ ìœ ì§€
DOM[4] = ì¼ë°˜ ìƒí’ˆ (ìƒˆ 3ë“±) â† ì¬ì •ë ¬ë¨

â†’ ì›ë³¸ êµ¬ì¡° ë³´ì¡´! ê´‘ê³ /íŠ¹ìˆ˜ì„¹ì…˜ì€ ê·¸ëŒ€ë¡œ, ì¼ë°˜ ìƒí’ˆë§Œ ì¬ì •ë ¬
```

---

## ì£¼ìš” íŒŒì¼ ë° í•¨ìˆ˜

### íŒŒì¼ êµ¬ì¡°

```
lib/
â”œâ”€â”€ workflows/
â”‚   â””â”€â”€ search_workflow.py         # ë©”ì¸ ì›Œí¬í”Œë¡œìš°
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ product_finder.py          # ìƒí’ˆ ê²€ìƒ‰ ë° DOM ë¶„ì„
â”‚   â”œâ”€â”€ rank_manipulator.py        # ìˆœìœ„ ì¡°ì‘
â”‚   â”œâ”€â”€ product_page_visitor.py    # ìƒí’ˆ ìƒì„¸ í˜ì´ì§€ ë°©ë¬¸
â”‚   â””â”€â”€ screenshot_processor.py    # ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ human_behavior_selenium.py # ì‚¬ëŒ í–‰ë™ ì‹œë®¬ë ˆì´ì…˜
â”œâ”€â”€ core/
â”‚   â””â”€â”€ browser_core_uc.py         # ë¸Œë¼ìš°ì € ì½”ì–´
â””â”€â”€ constants.py                    # ìƒìˆ˜ ë° ìƒíƒœ ì •ì˜
```

### ì£¼ìš” í•¨ìˆ˜ ë§¤í•‘

| ê¸°ëŠ¥ | íŒŒì¼ | í•¨ìˆ˜ | ë¼ì¸ |
|---|---|---|---|
| **ì›Œí¬í”Œë¡œìš° ì§„ì…ì ** | `search_workflow.py` | `run()` | 76-761 |
| **ìƒí’ˆ ê²€ìƒ‰** | `search_workflow.py` | `_search_and_find_product()` | ê´€ë ¨ ì„¹ì…˜ |
| **DOM êµ¬ì¡° ë¶„ì„** | `product_finder.py` | `analyze_product_list_structure()` | 26-168 |
| **ìƒí’ˆ ë§¤ì¹­** | `product_finder.py` | `find_product_by_ids()` | ê´€ë ¨ ì„¹ì…˜ |
| **ìˆœìœ„ ì¡°ì‘** | `rank_manipulator.py` | `move_product_to_rank()` | 45-132 |
| **ìƒí’ˆ ì¬ì •ë ¬** | `rank_manipulator.py` | `_reorder_products()` | 108-134 |
| **DOM ì¬êµ¬ì„±** | `rank_manipulator.py` | `_rebuild_dom_with_fixed_ads()` | 136-201 |
| **ì›Œí„°ë§ˆí¬ ì œê±°** | `rank_manipulator.py` | `_remove_all_watermarks()` | 405-457 |
| **ì›Œí„°ë§ˆí¬ ìƒì„±** | `rank_manipulator.py` | `_create_new_watermarks()` | 459-538 |
| **ìˆœì„œ ê²€ì¦** | `rank_manipulator.py` | `verify_new_order()` | 540-572 |
| **í•˜ì´ë¼ì´íŠ¸ ì ìš©** | `search_workflow.py` | `_highlight_product()` | ê´€ë ¨ ì„¹ì…˜ |
| **ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜** | `screenshot_processor.py` | `capture_with_overlay()` | ê´€ë ¨ ì„¹ì…˜ |
| **P/I/V ë®ì–´ì”Œìš°ê¸°** | `product_page_visitor.py` | Edit ëª¨ë“œ ë¡œì§ | ê´€ë ¨ ì„¹ì…˜ |

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: ë² ìŠ¤íŠ¸ìƒí’ˆì´ ìƒìœ„ë¡œ ì˜¬ë¼ê°

**ì¦ìƒ**:
```
ì›ë³¸:
1. ìƒí’ˆA
2. [ë² ìŠ¤íŠ¸ìƒí’ˆ]
3. ìƒí’ˆB

ì¬ì •ë ¬ í›„ (ì˜ëª»):
1. ìƒí’ˆB (ì´ë™)
2. [ë² ìŠ¤íŠ¸ìƒí’ˆ] â† ìƒìœ„ë¡œ ì˜¬ë¼ì˜´!
3. ìƒí’ˆA
```

**ì›ì¸**: ë² ìŠ¤íŠ¸ìƒí’ˆì´ ì¼ë°˜ ìƒí’ˆìœ¼ë¡œ ì˜ëª» ë¶„ë¥˜ë˜ì–´ ì¬ì •ë ¬ ëŒ€ìƒì´ ë¨

**í•´ê²°**: `ProductUnit_prodcutUnit__` í´ë˜ìŠ¤ ì²´í¬ë¡œ íŠ¹ìˆ˜ ì„¹ì…˜ ê°ì§€
- **ì½”ë“œ**: `product_finder.py:72-91`
- **ë¡œì§**: ProductUnit í´ë˜ìŠ¤ê°€ ì—†ìœ¼ë©´ `is_ad=True`ë¡œ ì„¤ì •í•˜ì—¬ ì›ìœ„ì¹˜ ê³ ì •

### ë¬¸ì œ 2: í•˜ì´ë¼ì´íŠ¸ê°€ ì›ë˜ ìœ„ì¹˜ì— ë‚¨ìŒ

**ì¦ìƒ**:
```
13ë“± ìƒí’ˆì„ 1ë“±ìœ¼ë¡œ ì´ë™ â†’ 1ë“± ìœ„ì¹˜ë¡œ ì´ë™ë¨
but, ë¹¨ê°„ í…Œë‘ë¦¬ì™€ P/I/V ë¼ë²¨ì€ 13ë“± ìœ„ì¹˜ì— ë‚¨ì•„ìˆìŒ
```

**ì›ì¸**: í•˜ì´ë¼ì´íŠ¸ë¥¼ ìˆœìœ„ ì¡°ì‘ **ì „ì—** ì ìš©í•˜ì—¬ ì›ë˜ ìœ„ì¹˜ì˜ DOM êµ¬ì¡°ì— í¬í•¨ë¨

**í•´ê²°**: í•˜ì´ë¼ì´íŠ¸ë¥¼ ìˆœìœ„ ì¡°ì‘ **í›„ì—ë§Œ** ì ìš©
- **ì½”ë“œ**: `search_workflow.py:608-792`
- **ìˆœì„œ**:
  1. ìŠ¤í¬ë¦°ìƒ· Before (í•˜ì´ë¼ì´íŠ¸ ì—†ìŒ)
  2. ìˆœìœ„ ì¡°ì‘
  3. í•˜ì´ë¼ì´íŠ¸ ì ìš© (ìƒˆ ìœ„ì¹˜ì—ë§Œ)
  4. ìŠ¤í¬ë¦°ìƒ· After

### ë¬¸ì œ 3: ê°™ì€ í˜ì´ì§€ ë‚´ ìˆœìœ„ ì´ë™ ì‹œ Stale Element

**ì¦ìƒ**: ê°™ì€ í˜ì´ì§€ì—ì„œ ìˆœìœ„ë§Œ ë³€ê²½ ì‹œ `StaleElementReferenceException` ë°œìƒ

**ì›ì¸**: í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì—†ì´ DOMë§Œ ì¬êµ¬ì„±í•˜ì—¬ WebElement ì°¸ì¡°ê°€ ìœ íš¨í•¨

**í•´ê²°**: ê°™ì€ í˜ì´ì§€ ì‹œë‚˜ë¦¬ì˜¤ì™€ ë‹¤ë¥¸ í˜ì´ì§€ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ êµ¬ë¶„
- **ì½”ë“œ**: `search_workflow.py:407-447`
- **ë¡œì§**:
  ```python
  if found_on_page == target_page_num:
      # ê°™ì€ í˜ì´ì§€: ìƒˆë¡œê³ ì¹¨ ìƒëµ, ê¸°ì¡´ element ì¬ì‚¬ìš©
  else:
      # ë‹¤ë¥¸ í˜ì´ì§€: í˜ì´ì§€ ì´ë™ í›„ element ë‹¤ì‹œ ì¶”ì¶œ
  ```

### ë¬¸ì œ 4: ë¡œì»¬ìŠ¤í† ë¦¬ì§€ê°€ ì‚­ì œë˜ì§€ ì•ŠìŒ

**ì¦ìƒ**: ë‹¤ìŒ ê²€ìƒ‰ ì‹œ ì´ì „ ê²€ìƒ‰ì–´ê°€ ë‚¨ì•„ìˆìŒ

**ì›ì¸**:
1. ì¿ íŒ¡ ë„ë©”ì¸ì´ ì•„ë‹Œ ê³³ì—ì„œ `localStorage.clear()` í˜¸ì¶œ
2. Same-origin policyë¡œ ì¸í•´ ì‚­ì œ ì‹¤íŒ¨

**í•´ê²°**:
1. ì¿ íŒ¡ ë„ë©”ì¸ìœ¼ë¡œ ë¨¼ì € ì´ë™
2. 3íšŒ ì¬ì‹œë„ + ì‚­ì œ ê²€ì¦
- **ì½”ë“œ**: `browser_core_uc.py:332-386`

---

## ë¶€ë¡: ì‹¤í–‰ ì˜ˆì‹œ

### ì‹œë‚˜ë¦¬ì˜¤: 13ë“± ìƒí’ˆì„ 1ë“±ìœ¼ë¡œ ì´ë™

```bash
python3 agent.py --version 134 --keyword "ë…¸íŠ¸ë¶" --edit \
  --product-id 8430027935 --item-id 33333331730 --vendor-item-id 92625424877 \
  --min-rank 1
```

#### ì‹¤í–‰ ë¡œê·¸

```
ğŸ” DOM êµ¬ì¡° ë¶„ì„:
   ì „ì²´ li ê°œìˆ˜: 28

   [ì „ì²´: 1/ì¼ë°˜: 1] - P:12345 / I:67890 / V:99999
   [ì „ì²´: 2] íŠ¹ìˆ˜ ì„¹ì…˜ ê°ì§€ (ProductUnit ì•„ë‹˜) - ì›ìœ„ì¹˜ ìœ ì§€
   [ì „ì²´: 3/ê´‘ê³ : 1] - P:54321 / I:98765 / V:11111
   [ì „ì²´: 4/ì¼ë°˜: 2] - P:22222 / I:33333 / V:44444
   ...
   [ì „ì²´:13/ì¼ë°˜:13] - P:8430027935 / I:33333331730 / V:92625424877 â† ì°¾ìŒ!

âœ… ìƒí’ˆ ë§¤ì¹­ ì„±ê³µ: 13ë“± (ì „ì²´ ìˆœìœ„)

ğŸ“¸ ë³€ê²½ ì „ ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜ (í•˜ì´ë¼ì´íŠ¸ ì—†ìŒ)
   screenshot_before.png

ğŸ”¨ DOM ì¬êµ¬ì„± ì‹œì‘...
   [íŠ¹ìˆ˜ ì„¹ì…˜] DOM 2 ìœ„ì¹˜ ìœ ì§€
   [ê´‘ê³  1] DOM 3 ìœ„ì¹˜ ìœ ì§€
   [ì¼ë°˜ 1] DOM 0 ìœ„ì¹˜ì— ë°°ì¹˜ â† 13ë“±ì´ 1ë“±ìœ¼ë¡œ
   [ì¼ë°˜ 2] DOM 1 ìœ„ì¹˜ì— ë°°ì¹˜
   ...

âœ… ì¬ë°°ì¹˜ í™•ì¸ ì™„ë£Œ: 27ê°œ ì¼ë°˜ ìƒí’ˆ

ğŸ“¸ ë³€ê²½ í›„ ìŠ¤í¬ë¦°ìƒ· ìº¡ì²˜
   screenshot_after.png

ğŸ“Š ìµœì¢… ê²°ê³¼ ìš”ì•½:
   ì›ë˜ ìˆœìœ„: 13ë“±
   ëª©í‘œ ìˆœìœ„: 1ë“±
   âœ… ìˆœìœ„ ë³€ê²½ ì„±ê³µ (13ë“± â†’ 1ë“±)
```

---

**ë¬¸ì„œ ë**
